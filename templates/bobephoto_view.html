{% extends "base.html" %}
{% block content %}
 
<div class="card-columns">
  
</div>

<script type="text/javascript">
var package_name = "{{arg['package_name'] }}";
var current_data = null;
var dataList = null;
function request_search(viewCount) {
  var formData = get_formdata('#form_search')
  formData += '&viewCount=' + viewCount;
  if (current_data == null ){
    formData += '&stCount=' + 0;
  }else{
    formData += '&stCount=' + current_data.viewCount;
  }
  $.ajax({
    url: '/' + package_name + '/ajax/select',
    type: "POST", 
    cache: false,
    data: formData,
    dataType: "json",
    success: function (data) {
      current_data = data;
      make_list(data.list);
    }
  });
}
$(window).resize(function() { 
  var size = window.innerWidth;
  $('main.container').css("max-width",size);
  var cnt = Math.round( window.innerWidth / 400 );
  $('.card-columns').css("column-count",cnt);
});
function make_list(data) {
  str = '';
  for (i in data) {
    $('div.card-columns').append('<div class="card">    <img src="/bobephoto/api/image?id='+data[i].id+'" class="card-img-top" alt="'+data[i].id+'">  </div>')
  }
}

$(document).ready(function(){

  if( window.innerWidth > 1200 ){
    $('main.container').css("max-width",window.innerWidth)
  }
  request_search(30);
});

$(window).scroll(function(){
  if($(document).height() <= $(window).scrollTop() + $(window).height()){
    //debugger;
    request_search(30);
  }
});

</script>    
{% endblock %}